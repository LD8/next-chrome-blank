{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport { Modal, ModalOverlay, ModalContent, ModalHeader, ModalFooter, ModalBody, Button, FormControl, FormLabel, Input, Flex, Spacer, Box, useDisclosure, InputLeftAddon, InputRightAddon, InputGroup } from '@chakra-ui/react';\n\nvar AddOrEditModal = function AddOrEditModal(_ref) {\n  var dispatch = _ref.dispatch,\n      cardData = _ref.cardData,\n      index = _ref.index,\n      setOpenedCardIndex = _ref.setOpenedCardIndex;\n\n  var _useDisclosure = useDisclosure(),\n      isOpen = _useDisclosure.isOpen,\n      onOpen = _useDisclosure.onOpen,\n      onClose = _useDisclosure.onClose;\n\n  var _useState = useState(''),\n      siteName = _useState[0],\n      setSiteName = _useState[1];\n\n  var _useState2 = useState(''),\n      url = _useState2[0],\n      setUrl = _useState2[1];\n\n  useEffect(function () {\n    // console.log('index changed to: ', index)\n    if (index !== null) {\n      onOpen();\n\n      if (index >= 0) {\n        // 显示现有数据\n        setSiteName(cardData[index].text);\n        setUrl(cardData[index].href.replace(/^http:\\/\\//, '').replace(/\\/$/, ''));\n      }\n    } else {\n      // 如果是 null 说明需要关闭 modal\n      onClose();\n    }\n  }, [index]);\n\n  var handleSubmit = function handleSubmit() {\n    if (siteName.trim() === '' || url.trim() === '') {\n      return;\n    }\n\n    var datum = {\n      href: \"http://\".concat(url, \"/\"),\n      text: siteName\n    };\n\n    if (index >= 0) {\n      console.log('正在修改现有数据');\n      dispatch({\n        type: 'edit_card',\n        payload: {\n          index: index,\n          datum: datum\n        }\n      });\n    } else {\n      console.log('正在添加新数据');\n      dispatch({\n        type: 'add_card',\n        payload: {\n          datum: datum\n        }\n      });\n    }\n\n    handleModalClose();\n  };\n\n  var handleDelete = function handleDelete() {\n    console.log('正在删除数据');\n    dispatch({\n      type: 'del_card',\n      payload: {\n        index: index\n      }\n    });\n    handleModalClose();\n  };\n\n  var handleModalClose = function handleModalClose() {\n    setSiteName('');\n    setUrl(''); // 设置 index 为 null 是关闭 modal 的机制\n\n    setOpenedCardIndex(null);\n  };\n\n  var handleEnter = function handleEnter(e) {\n    if (e.key === 'Enter') {\n      handleSubmit();\n    }\n  };\n\n  return /*#__PURE__*/_jsxs(Modal, {\n    isOpen: isOpen,\n    onClick: onClose,\n    motionPreset: \"slideInBottom\",\n    isCentered: true,\n    children: [/*#__PURE__*/_jsx(ModalOverlay, {}), /*#__PURE__*/_jsxs(ModalContent, {\n      children: [/*#__PURE__*/_jsx(ModalHeader, {\n        children: \"Add shortcut\"\n      }), /*#__PURE__*/_jsxs(ModalBody, {\n        pb: 6,\n        children: [/*#__PURE__*/_jsxs(FormControl, {\n          children: [/*#__PURE__*/_jsx(FormLabel, {\n            children: \"Website Name\"\n          }), /*#__PURE__*/_jsx(Input, {\n            placeholder: \"Website Name\",\n            onKeyUp: handleEnter,\n            value: siteName,\n            onChange: function onChange(e) {\n              return setSiteName(e.target.value);\n            }\n          })]\n        }), /*#__PURE__*/_jsxs(FormControl, {\n          mt: 4,\n          children: [/*#__PURE__*/_jsx(FormLabel, {\n            children: \"URL\"\n          }), /*#__PURE__*/_jsxs(InputGroup, {\n            children: [/*#__PURE__*/_jsx(InputLeftAddon, {\n              children: \"http://\"\n            }), /*#__PURE__*/_jsx(Input, {\n              placeholder: \"URL\",\n              onKeyUp: handleEnter,\n              value: url,\n              onChange: function onChange(e) {\n                return setUrl(e.target.value);\n              }\n            }), /*#__PURE__*/_jsx(InputRightAddon, {\n              children: \"/\"\n            })]\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(ModalFooter, {\n        children: /*#__PURE__*/_jsxs(Flex, {\n          w: \"100%\",\n          children: [index !== -1 && index !== null && /*#__PURE__*/_jsx(Button, {\n            colorScheme: \"red\",\n            mr: 3,\n            onClick: handleDelete,\n            children: \"Delete\"\n          }), /*#__PURE__*/_jsx(Spacer, {}), /*#__PURE__*/_jsxs(Box, {\n            children: [/*#__PURE__*/_jsx(Button, {\n              colorScheme: \"blue\",\n              mr: 3,\n              onClick: handleSubmit,\n              children: \"Save\"\n            }), /*#__PURE__*/_jsx(Button, {\n              onClick: handleModalClose,\n              children: \"Cancel\"\n            })]\n          })]\n        })\n      })]\n    })]\n  });\n};\n\nexport default AddOrEditModal;","map":null,"metadata":{},"sourceType":"module"}